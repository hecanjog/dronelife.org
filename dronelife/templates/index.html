{% extends "layout.html" %}
{% block body %}

<div class="main-column">
    {% for topic in topics %}
    {% if topic.threads.count() > 0 %}
        <h2>{{ topic.content }}</h2>
        <ul class="recent-threads">
                {% for thread in topic.threads.order_by('posted desc').limit(5) %}
                <li class="recent-thread"><a href="{{ thread.getUrl() }}">{{ thread.title }}</a></li>
            {% endfor %}
        </ul>
    {% endif %}
{% endfor %}
</div>


<div class="sidebar">
{% if current_user.is_authenticated() %}
<form method="post" action="/threads">
<fieldset>
    <legend>New Thread</legend>
    {{ form.topic_id.label }}
    {{ form.topic_id() }}
    {{ form.title.label }}
    {{ form.title(size=(80)) }}

    {{ form.content.label }}
    {{ form.content(rows=20) }}
    <button type="submit">post</button>
</fieldset>
</form>
{% endif %}

    <ul class="recent-comments">
        {% for comment in comments %}
            <li>{{ comment.content | safe }}</li>
        {% endfor %}
    </ul>
</div>

{% endblock %}
